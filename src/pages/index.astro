---
// src/pages/index.astro
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
const BASE_URL = import.meta.env.BASE_URL || '/';

// Get all posts from the "blog" collection
const posts = await getCollection('blog');
---

<BaseLayout title="Top Water Angler">
  <section class="hero">
    <h1>Top Water Angler</h1>
    <p>Expert tips, tactics, and stories for freshwater and saltwater fishing.</p>
    <a href={`${BASE_URL}blog/`} class="btn-primary">Read the Blog</a>
  </section>

  <section class="latest-posts">
    <h2>Latest Posts</h2>
    <div class="post-grid">
      {posts.map(post => (
        <article class="post-card">
          {post.data.image && <img src={post.data.image} alt={post.data.title} />}
          <h3><a href={`${BASE_URL}blog/${post.slug}/`}>{post.data.title}</a></h3>
          <p>{post.data.description}</p>
          <a href={`${BASE_URL}blog/${post.slug}/`} class="btn-secondary">Read Article</a>
        </article>
      ))}
    </div>
    <div class="view-all">
      <a href={`${BASE_URL}blog/`} class="btn-primary">View All Articles</a>
    </div>
  </section>
</BaseLayout>
