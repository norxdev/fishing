---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';

const posts = await getCollection('blog');
posts.sort((a, b) => new Date(b.data.publishDate) - new Date(a.data.publishDate));
const featured = posts[0];
const others = posts.slice(1);
---

<BaseLayout title="Top Water Angler" description="Fishing tips, gear, and adventure stories.">

  <!-- Hero / Featured Post -->
  {featured && (
    <section style="margin-bottom: 3rem;">
      <div class="post-card" style="overflow:hidden;">
        <img 
          src={featured.data.image || "https://source.unsplash.com/900x350/?fishing"} 
          alt={featured.data.title} 
          style="width:100%; height:350px; object-fit:cover;" 
        />
        <div style="padding:1.5rem;">
          <h2><a href={`/fishing/blog/${featured.slug}/`}>{featured.data.title}</a></h2>
          <p style="color:#555;">{new Date(featured.data.publishDate).toLocaleDateString()}</p>
          <p>{featured.data.description}</p>
          <a class="button" href={`/fishing/blog/${featured.slug}/`}>Read More →</a>
        </div>
      </div>
    </section>
  )}

  <!-- Grid of other posts -->
  <section class="post-grid" style="display:grid; gap:2rem; grid-template-columns:repeat(auto-fit,minmax(300px,1fr));">
    {others.map(post => (
      <div class="post-card">
        <img 
          src={post.data.image || "https://source.unsplash.com/600x300/?fishing"} 
          alt={post.data.title} 
        />
        <h3><a href={`/fishing/blog/${post.slug}/`}>{post.data.title}</a></h3>
        <p style="color:#555;">{new Date(post.data.publishDate).toLocaleDateString()}</p>
        <p>{post.data.description}</p>
        <a class="button" href={`/fishing/blog/${post.slug}/`}>Read →</a>
      </div>
    ))}
  </section>

</BaseLayout>
