---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';

const posts = await getCollection('blog');
posts.sort((a, b) => new Date(b.data.publishDate) - new Date(a.data.publishDate));
---

<BaseLayout title="Top Water Angler" description="Catch the latest fishing tips, gear reviews, and adventure stories.">

  <section class="featured-post">
    {posts.length > 0 && (
      <div class="post-card">
        <img src={posts[0].data.image || "https://source.unsplash.com/900x400/?fishing"} alt={posts[0].data.title} />
        <h2><a href={`/fishing/blog/${posts[0].slug}/`}>{posts[0].data.title}</a></h2>
        <p class="post-date">{posts[0].data.publishDate ? new Date(posts[0].data.publishDate).toLocaleDateString("en-US", { year: "numeric", month: "long", day: "numeric" }) : ""}</p>
        <p>{posts[0].data.description}</p>
        <a class="button" href={`/fishing/blog/${posts[0].slug}/`}>Read →</a>
      </div>
    )}
  </section>

  <section class="post-grid">
    {posts.slice(1).map(post => (
      <div class="post-card">
        <img src={post.data.image || "https://source.unsplash.com/600x300/?fishing"} alt={post.data.title} />
        <h3><a href={`/fishing/blog/${post.slug}/`}>{post.data.title}</a></h3>
        <p class="post-date">{post.data.publishDate ? new Date(post.data.publishDate).toLocaleDateString("en-US", { year: "numeric", month: "long", day: "numeric" }) : ""}</p>
        <p>{post.data.description}</p>
        <a class="button" href={`/fishing/blog/${post.slug}/`}>Read →</a>
      </div>
    ))}
  </section>

</BaseLayout>
