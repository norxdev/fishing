---
import { getCollection } from "astro:content";
import BaseLayout from "../layouts/BaseLayout.astro";

const posts = await getCollection("blog");
posts.sort((a, b) => new Date(b.data.publishDate) - new Date(a.data.publishDate));
---

<BaseLayout title="Top Water Angler Blog" description="Catch the latest fishing tips, gear reviews, and adventure stories.">
  <h1>Blog</h1>
  <section class="post-grid">
    {posts.map(post => (
      <div class="post-card">
        <img src={post.data.image || `${Astro.base}default.jpg`} alt={post.data.title} />
        <h3><a href={`${Astro.base}blog/${post.slug}/`}>{post.data.title}</a></h3>
        <p>{new Date(post.data.publishDate).toLocaleDateString()}</p>
        <p>{post.data.description}</p>
        <a class="button" href={`${Astro.base}blog/${post.slug}/`}>Read â†’</a>
      </div>
    ))}
  </section>
</BaseLayout>
