<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Fishing Blog</title>

  <meta name="description" content="In-depth fishing guides covering gear, tackle, techniques, and how-to advice for anglers of all levels.">

  <link rel="stylesheet" href="global.css">
</head>
<body>

  <div class="container">

    <header>
      <h1 class="site-title">Fishing Blog</h1>
    </header>

    <main id="posts"></main>

  </div>

  <script src="posts.js"></script>
  <script>
    const container = document.getElementById("posts");

    async function loadPosts() {
      for (const post of posts) {
        try {
          const response = await fetch(`posts/${post.slug}`);
          const html = await response.text();

          const parser = new DOMParser();
          const doc = parser.parseFromString(html, "text/html");

          const firstParagraph =
            doc.querySelector(".post-content p")?.innerText ||
            "Read this post for more details.";

          const snippet =
            firstParagraph.length > 160
              ? firstParagraph.substring(0, 160) + "…"
              : firstParagraph;

          const article = document.createElement("article");
          article.className = "post-preview";

          article.innerHTML = `
            <h2>${post.title}</h2>
            <small>${post.date}</small>
            <p>${snippet}</p>
            <a href="posts/${post.slug}">Read more →</a>
          `;

          container.appendChild(article);
        } catch (err) {
          console.error("Failed to load post:", post.slug);
        }
      }
    }

    loadPosts();
  </script>

</body>
</html>
